;;*****************************************************************************
;;
;; Routine:     DatabaseDisconnect
;;
;; Description: Disconnect from the database
;;
;; Author:      Steve Ives, Synergex Professional Services Group
;;
;; Created:     30th December 2019
;;
;;*****************************************************************************
;;

import Replicator
import ReplicationLibrary

subroutine DatabaseDisconnect
proc
    try
    begin
        using Settings.ConnectionMode select
        (DatabaseConnectionMode.SqlConnection),
        begin
            data dbstatus, int
            Logger.Log(" - Attempting to close database channel")
            dbstatus = %ssc_release(Settings.DatabaseChannel)
        end
        (DatabaseConnectionMode.SqlClient),
        begin
.ifdef DBLNET
            Settings.DatabaseConnection.Close()
.endc
        end
        endusing
    end
    catch (e, @Exception)
    begin
        nop
    end
    endtry

    xreturn

endsubroutine

